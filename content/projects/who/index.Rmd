---
title: 'Pre-programme Assignment 1'
author: "Andrea Gerards"
date: "12/09/2020"
output:
  word_document:
    toc: yes
  html_document:
    highlight: zenburn
    theme: flatly
    toc: yes
    toc_float: yes
---


```{r load-libraries, warning=FALSE, message=FALSE, echo=FALSE}
library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages
library(gapminder)  # gapminder dataset
library(here)
```

> Please delete all the intro tet I wrote from line 22 to line 69 and start writing your short biography after this blockquote.

# Task 1: Short biography written using markdown

## Origins
My name is Andrea Gerards and I am half German and half Italian. I grew up in **Italy**, in a city close to the Austrian border called **Bolzano**. I have played [Basketball](https://www.altoadige.it/sport/piani-l-under-15-si-laurea-campione-del-triveneto-1.413004) for over a decade but always used  to practice other activities including tennis, football, volleyball and golf. 

## Education
I have attended a high school in scientific studies in Bolzano. My passion for economic matters led me then to join *Bocconi* in Milan for my Bachelor's and I am now happy to be part of the *LBS* community. 

## Professional experiences
I have gained experience through a number of internships. My completed internships at **Deloitte**, **Macquarie**, **PAI** and **Credit Suisse** allowed me to get a unique insight in the fascinating financial sector.

![Credit Suisse office in Canary Wharf](https://c8.alamy.com/comp/BXBN6D/the-swiss-bank-credit-suisse-in-canary-wharf-london-england-united-BXBN6D.jpg)

# Task 2: `Gapminder` country comparison

You have seen the `gapminder` dataset that has data on life expectancy, population, and GDP per capita for 142 countries from 1952 to 2007. To get a glipmse of the dataframe, namely to see the variable names, variable types, etc., we use the `glimpse` function. We also want to have a look at the first 20 rows of data.

```{r}
glimpse(gapminder)

head(gapminder, 20) # look at the first 20 rows of the dataframe

```

Your task is to produce two graphs of how life expectancy has changed over the years for the `country` and the `continent` you come from. 

I have created the `country_data` and `continent_data` with the code below. 

```{r}
country_data <- gapminder %>% 
            filter(country == "Greece") # just choosing Greece, as this is where I come from

continent_data <- gapminder %>% 
            filter(continent == "Europe")
```

First, create a plot of life expectancy over time for the single country you chose. You should use  `geom_point()` to see the actual data points and `geom_smooth(se = FALSE)`  to plot the underlying trendlines. You need to remove the comments **#** from the lines below for your code to run.

```{r, lifeExp_one_country}
# plot1 <- ggplot(data = ??, mapping = aes(x = ??, y = ??))+
#   geom_??() +
#   geom_smooth(se = FALSE)+
#   NULL 

# plot1
```

Next we need to add a title. Create a new plot, or extend plot1, using the `labs()` function to add an informative title to the plot.

```{r, lifeExp_one_country_with_label}
# plot 1<- ggplot(data = ??, mapping = aes(x = ??, y = ??))+
#   geom_??() +
#   geom_smooth(se = FALSE) +
#   labs(title = " ",
#       x = " ",
#       y = " ") +
#   NULL


# print(plot1)
```


Secondly, produce a plot for all countries in the *continent* you come from. (Hint: map the `country` variable to the colour aesthetic).  

```{r lifeExp_one_continent}
# ggplot(data =  , mapping = aes(x =  , y =  , colour= ))+
#   geom_?? + 
#   geom_smooth(se = FALSE) +
#   NULL
```

Finally, using the original `gapminder` data, produce a life expectancy over time graph, grouped (or faceted) by continent. We will remove all legends, adding the `theme(legend.position="none")` in the end of our ggplot.

```{r lifeExp_facet_by_continent}
# ggplot(data = gapminder , mapping = aes(x =  , y =  , colour= ))+
#   geom_??? + 
#   geom_smooth(se = FALSE) +
#   facet_wrap(~continent) +
#   theme(legend.position="none") + #remove all legends
#   null
```

Given these trends, what can you say about life expectancy since 1952? Again, don't just say what's happening in the graph. Tell some sort of story and speculate about the differences in the patterns.

> Type your answer after this blockquote.

```{r}
country_data <- gapminder %>% 
filter(country == "Italy")

continent_data <- gapminder %>% 
filter(continent == "Europe")

plot1 <- ggplot(country_data, aes(x = year, y = lifeExp)) + geom_point() + geom_smooth(se = FALSE) +  labs(title = "Life Expectancy in Italy between 1952 - 2007", x = "Year", y = "Life Expectancy")

plot1

plot2 <- ggplot(continent_data, aes(x = year, y = lifeExp, color = country)) + geom_point() + geom_smooth(se = FALSE) + labs(title = "Life Expectancy in Europe between 1952 - 2007", x = "Year", y = "Life Expectancy")

plot2

plot3 <- ggplot(gapminder, aes(x = year, y = lifeExp, colour = )) + geom_point() + geom_smooth(se = FALSE) + facet_wrap(~continent) + theme(legend.position="none") + labs(title = "Life expectancy across continents between 1952 - 2007", x = "Year", y = "Life Expectancy")

plot3
```

## Commentary
Life expectancy overall has been significantly increasing around the globe since 1952. Deepening the data from plot1 about Italy, the numbers clearly highlight the positive results of the economic as well as social policies undergone by the Italian government since the end of the 2nd world war. In fact, the 70s in Italy have been characterized by a so called "economic miracle", in which individuals were wealthier and socially more protected, both factors that definitely played a role in the life expectancy increase underlined in the data.

With regards to the European countries and continents plotted in plot 2 and 3, an overall positive trend characterizes the different economies as well. A part from a process of economic recovery most very similar to Italy that global countries underwent following the 2nd world war, an increase in the accuracy and efficacy of medical treatments needs to be taken into account as well. In 1957 one of the very first cardiac surgeries was carried out as well as several newly developed drugs were globally launched. Finally, if focusing on the different continent's trajectories, various factors need to be highlighted. Africa is showing the flattest growth line among all other continents, indicating a potential reverse of the trend but also caused by past very steep growths. Oceania has been showing the overall highest life expactancy, potentially caused by a potential marginal role the continent has played during the previous two world conflicts. 

# Task 3: Brexit voting

We will have a quick look at the results of the 2016 Brexit vote in the UK. First we read the data using `read_csv()` and have a quick glimpse at the data

```{r load_brexit_data, message=FALSE, warning=FALSE}
brexit_results <- read_csv(here::here("Data","brexit_results.csv"))


glimpse(brexit_results)
```


The data comes from [Elliott Morris](https://www.thecrosstab.com/), who cleaned it and made it available through his [DataCamp class on analysing election and polling data in R](https://www.datacamp.com/courses/analyzing-election-and-polling-data-in-r).

Our main outcome variable (or y) is `leave_share`, which is the percent of votes cast in favour of Brexit, or leaving the EU. Each row is a UK [parliament constituency](https://en.wikipedia.org/wiki/United_Kingdom_Parliament_constituencies). 

To get a sense of the spread of the data, plot a histogram and a density plot of the leave share in all constituencies.

```{r brexit_histogram, warning=FALSE, message=FALSE}
ggplot(brexit_results, aes(x = leave_share)) +
  geom_histogram(binwidth = 2.5)

ggplot(brexit_results, aes(x = leave_share)) +
  geom_density()
```

One common explanation for the Brexit outcome was fear of immigration and opposition to the EU's more open border policy. We can check the relationship (or correlation) between the proportion of native born residents (`born_in_uk`) in a constituency and its `leave_share`. To do this, let us get the correlation between the two variables

```{r brexit_immigration_correlation}
brexit_results %>% 
  select(leave_share, born_in_uk) %>% 
  cor()
```

The correlation is almost 0.5, which shows that the two variables are positively correlated. 

We can also create a scatterplot between these two variables using `geom_point`. We also add the best fit line, using  `geom_smooth(method = "lm")`. 

```{r brexit_immigration_plot}
ggplot(brexit_results, aes(x = born_in_uk, y = leave_share)) +
  geom_point(alpha=0.3) +
  geom_smooth(method = "lm") +
  theme_bw() +
  NULL
```

You have the code for the plots, I would like you to revisit all of them and use the `labs()` function to add an informative title, subtitle, and axes titles to all plots.

What can you say about the relationship shown above? Again, don't just say what's happening in the graph. Tell some sort of story and speculate about the differences in the patterns.

> Type your answer after, and outside, this blockquote.

```{r brexit_histogram1, warning=FALSE, message=FALSE}
ggplot(brexit_results, aes(x = leave_share)) +
  geom_histogram(binwidth = 2.5) + labs(title = "Plot 1", subtitle = "Percentage of Brexit votes across constituencies", y = "UK parliamentary constituencies", x = "% of pro - Brexit votes")

ggplot(brexit_results, aes(x = leave_share)) +
  geom_density() + labs(title = "Plot 2", subtitle = "Density function of Brexit votes across constituencies", y = "density", x = "% of pro - Brexit votes")

brexit_results %>% 
  select(leave_share, born_in_uk) %>% 
  cor()

ggplot(brexit_results, aes(x = born_in_uk, y = leave_share)) +
  geom_point(alpha=0.3) +
  geom_smooth(method = "lm") +
  theme_bw() + labs(title = "Graph 3", subtitle = "Scatterplot of correlation between % of Brexit votes and % of native born residents", x = "% of UK born residents", y = "% of pro - Brexit votes")
```

## Commentary
The plots quite clearly highlight the positive correlation between being born/residing in the UK and wanting to leave the EU. Notwithstanding a non perfect correlation of 0.5, the relationship between these two variables is potentially highly driven by social and economic constituencies-related factors. As a matter of fact, the rural and less wealthy parts of the UK are known to be the ones more in favour of Brexit and potentially also more impacted by external phenomena as immigration. Rural areas would be typically populated by greater percentages of UK native residents, and this would definitely impact the data correlation observation.  


# Submit the assignment

Knit the completed R Markdown file as ah HTML or Word document (use the "Knit" button at the top of the script editor window) and upload it to Canvas.


## Details

If you want to, please answer the following

- Who did you collaborate with:
- Approximately how much time did you spend on this problem set: 2hr
- What, if anything, gave you the most trouble: 
